---
title: "Data Report"
author: "Ethan Weiland"
date: "2024-03-21"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library(tidyverse)
library(stargazer)
library(gridExtra)
load("rotten_tomatoes.RData")
```

## 1. Introduction

The contemporary United States is experiencing low levels of societal trust. Surveys show that Americans do not trust newspapers, universities, the Supreme Court, and other key institutions. This analysis examines whether this anti-establishment sentiment extends into the cultural sphere. Specifically, I look at the opinions of the general public and elite critics on a key cultural good: movies. Using data from Rotten Tomatoes, two research questions are asked:

1. What is the association between critic opinion and public opinion for films?
2. Has the association between critic opinion and public opinion for films changed over time, especially during the 21st century?

## 2. Data

```{r, include=FALSE}
n <- nrow(rotten_tomatoes)
```

The data for this analysis comes from the popular website Rotten Tomatoes. Rotten Tomatoes contains information on a plethora of movies, and for each movie it reports a “Tomatometer” (average critic score) and an “Audience Score” (average audience score). Additionally, Rotten Tomatoes contains information on other movie characteristics like release date, box office gross, run time, etc. A Kaggle user scraped Rotten Tomatoes and made the data freely available at the following link: https://www.kaggle.com/datasets/andrezaza/clapper-massive-rotten-tomatoes-movies-and-reviews/. This repository contains two tables used for this analysis: a first table of information on 140,000 movies and a second table of information on 1,400,000 individual critic reviews of these movies. 

The dependent variable of interest is public opinion. Public opinion is operationalized as “Audience Score” for each movie, which is an aggregated score of individual user ratings of a movie on Rotten Tomatoes. Movies without an audience score were dropped. 

The first independent variable of interest is critic opinion. Each movie contains an associated “TomatoMeter”, which is an aggregate of the critic reviews. However, the definition of “critics” used in the TomatoMeter is too broad, so this analysis instead calculates a modified TomatoMeter which only considers reviews from critics classified as “Top Critics”. Top Critics are critics that work for established and well-known publications (e.g., The New York Times), who best represents elite opinion.  To calculate this modified TomatoMeter using only Top Critics, the table of individual reviews was used. Individual critics score films on different scales so directly comparing scores can result in measurement problems. However, for each review Rotten Tomatoes reports whether the review is "fresh" (a positive review) or "rotten" (a negative review). For each film, critic opinion is the percentage of "fresh" reviews. The overall critic opinion is "fresh" if greater than or equal to 50% of critic reviews are "fresh" and "rotten" otherwise. To prevent one critic’s review from dominating, only movies with at least two top critic scores were included.

The second independent variable of interest is release date. Two potential dates are available from the Rotten Tomatoes data: the release date in theaters and the release date on streaming. The release date in theaters is chosen because films in theaters are more likely to be seen and reviewed by critics than films released straight to streaming (especially before the COVID pandemic). To fill in missing values on release dates, the Rotten Tomatoes data was supplemented with data from The Movie DataBase (TMDB). A Kaggle user posts the complete dataset from TMDB daily, which is freely available at the following link (https://www.kaggle.com/datasets/asaniczka/tmdb-movies-dataset-2023-930k-movies). If a film had a valid release date from the Rotten Tomatoes data, this value was used. If a film had a missing release date from the Rotten Tomatoes data, and a non-missing release date from the TMDB data, the latter value was used. The films that still had a missing value on release date were dropped. 

Various control variables are included. The box office variable refers to the monetary success of the movie in millions of dollars. Due to missing data, this variable was also supplemented with data from TMDB in the same manner as the release date variable. Language refers to the original language of the film. Language is a factor variable with two levels: "English" and "Non-English". Run time refers to the length of the film (in minutes). Review count refers to the number of Top Critic reviews for each film. As described above, the minimum review count value is 2. After cleaning the data and removing films without a valid critic score, audience score, or release date, the final sample size is `r n`.

## 3. Descriptive Statistics


```{r, echo=FALSE, results="asis"}
percent_missing <- function(x) { # function to calculate the % of a vector that is NA
  output <- sum(is.na(x)) / length(x)
  output <- output * 100
  return(output)
}

table1 <- data.frame(Mean = c(mean(rotten_tomatoes$audience_score, na.rm=T),
                              mean(rotten_tomatoes$critic_score, na.rm=T),
                              mean(rotten_tomatoes$release_date, na.rm=T),
                              mean(rotten_tomatoes$box_office, na.rm=T),
                              sum(rotten_tomatoes$language=="English", na.rm=T) / sum(!is.na(rotten_tomatoes$language)),
                              mean(rotten_tomatoes$runtime, na.rm=T),
                              mean(rotten_tomatoes$review_count, na.rm=T)),
                     Median = c(median(rotten_tomatoes$audience_score, na.rm=T),
                                median(rotten_tomatoes$critic_score, na.rm=T),
                                median(rotten_tomatoes$release_date, na.rm=T),
                                median(rotten_tomatoes$box_office, na.rm=T),
                                NA,
                                median(rotten_tomatoes$runtime, na.rm=T),
                                median(rotten_tomatoes$review_count, na.rm=T)),
                     SD = c(sd(rotten_tomatoes$audience_score, na.rm=T),
                            sd(rotten_tomatoes$critic_score, na.rm=T),
                            NA,
                            sd(rotten_tomatoes$box_office, na.rm=T),
                            NA,
                            sd(rotten_tomatoes$runtime, na.rm=T),
                            sd(rotten_tomatoes$review_count, na.rm=T)),
                     Percent_Missing = c(percent_missing(rotten_tomatoes$audience_score),
                                         percent_missing(rotten_tomatoes$critic_score),
                                         percent_missing(rotten_tomatoes$release_date),
                                         percent_missing(rotten_tomatoes$box_office),
                                         percent_missing(rotten_tomatoes$language),
                                         percent_missing(rotten_tomatoes$runtime),
                                         percent_missing(rotten_tomatoes$review_count)))
rownames(table1) <- c("Audience Score",
                      "Critic Score (% of 'Fresh' Reviews)",
                      "Release Date",
                      "Box Office (Millions $)", 
                      "Language (1=English)", 
                      "Run Time (Minutes)", 
                      "Review Count")
stargazer(table1,
          title=paste0("Descriptive Statistics (n = ", nrow(rotten_tomatoes), ")"),
          summary=FALSE,
          header=FALSE,
          digits=2)
```

```{r, echo=FALSE}
figure1 <- ggplot(rotten_tomatoes, aes(x=audience_score)) +
  geom_histogram(bins=30, fill="#619CFF", color="black") +
  labs(title="Figure 1. Distribution of Audience\nScores",
       x="Audience Score (%)",
       y="Count")

figure1

figure2 <- ggplot(rotten_tomatoes, aes(x=critic_score)) +
  geom_histogram(bins=30, fill="#F8766D", color='black') +
  labs(title="Figure 2. Distribution of Critic\nScores (Continuous)",
       x="Critic Score (% 'Fresh' Reviews)",
       y="Count")

figure3 <- ggplot(rotten_tomatoes, aes(x=critic_score_mode)) +
  geom_bar(fill="#F8766D", color="black") +
  labs(title="Figure 3. Distribution of Critic\nScores (Discrete)",
       y="Count",
       x="Overall Critic Score")

grid.arrange(figure2, figure3, ncol=2)

```

## 4. Association Between Audience Score and Critic Score

```{r, echo=FALSE}
figure4 <- ggplot(rotten_tomatoes, aes(x=critic_score, y=audience_score)) +
  geom_point(alpha=0.2) +
  geom_smooth(method="loess", formula="y~x", se=F) +
  labs(title="Figure 4. Audience Score vs. Critic Score (Continuous)",
       y="Audience Score",
       x="Critic Score (% 'Fresh' Reviews)")
figure4

figure5 <- ggplot(rotten_tomatoes, aes(x=critic_score_mode, y=audience_score)) +
  geom_boxplot() +
  labs(title="Figure 5. Audience Score vs. Critic Score (Discrete)",
       y="Audience Score",
       x="Overall Critic Score")
figure5
```

```{r, echo=FALSE, results="asis"}
table2 <- rotten_tomatoes %>%
  group_by(critic_score_mode) %>%
  summarize(Mean = round(mean(audience_score), 2),
            Median = median(audience_score),
            SD = round(sd(audience_score), 2))
colnames(table2)[1] <- "Overall Critic Score"
stargazer(table2,
          title="Audience Score by Overall Critic Score",
          digits=2,
          header=FALSE,
          summary=FALSE,
          rownames=FALSE)
```

# 5. Association Between Audience Score and Critic Score Over Time

```{r, echo=FALSE}
rotten_tomatoes$period <- ifelse(rotten_tomatoes$release_date <= "1999-12-31", "Before 2000", NA)
rotten_tomatoes$period <- ifelse(rotten_tomatoes$release_date >= "2000-01-01" & rotten_tomatoes$release_date <= "2004-12-31", "2000-2004", rotten_tomatoes$period)
rotten_tomatoes$period <- ifelse(rotten_tomatoes$release_date >= "2005-01-01" & rotten_tomatoes$release_date <= "2009-12-31", "2005-2009", rotten_tomatoes$period)
rotten_tomatoes$period <- ifelse(rotten_tomatoes$release_date >= "2010-01-01" & rotten_tomatoes$release_date <= "2014-12-31", "2010-2014", rotten_tomatoes$period)
rotten_tomatoes$period <- ifelse(rotten_tomatoes$release_date >= "2015-01-01" & rotten_tomatoes$release_date <= "2019-12-31", "2015-2019", rotten_tomatoes$period)
rotten_tomatoes$period <- ifelse(rotten_tomatoes$release_date >= "2020-01-01", "2020-Present", rotten_tomatoes$period)
rotten_tomatoes$period <- factor(rotten_tomatoes$period, levels=c("Before 2000",
                                                                  "2000-2004",
                                                                  "2005-2009",
                                                                  "2010-2014",
                                                                  "2015-2019",
                                                                  "2020-Present"))

figure6 <- ggplot(rotten_tomatoes, aes(x=critic_score, y=audience_score)) +
  geom_point(alpha=0.2) +
  geom_smooth(method="loess", formula="y~x", se=F) +
  facet_wrap(~period) +
  labs(title="Figure 6. Audience Score vs. Critic Score Over Time (Continuous)",
       y="Audience Score",
       x="Critic Score (% 'Fresh' Reviews)")
figure6

figure7 <- ggplot(rotten_tomatoes, aes(x=critic_score_mode, y=audience_score)) +
  geom_boxplot() +
  facet_wrap(~period) +
  labs(title="Figure 7. Audience Score vs. Critic Score Over Time (Discrete)",
       y="Audience Score",
       x="Overall Critic Score")
figure7

```

```{r, include=FALSE}
table3 <- rotten_tomatoes %>%
  group_by(period, critic_score_mode) %>%
  summarize(Mean = round(mean(audience_score), 2),
            Median = median(audience_score),
            SD = round(sd(audience_score), 2))
table3$period <- as.character(table3$period)
colnames(table3)[1] <- "Period"
colnames(table3)[2] <- "Overall Critic Score"
```

```{r, echo=FALSE, results="asis"}
colnames(table3)[1] <- "Period"
colnames(table3)[2] <- "Overall Critic Score"
stargazer(table3,
          title="Audience Score by Overall Critic Score Over Time",
          rownames=F,
          digits=2,
          header=F,
          summary=F)
```


## 6. GitHub Link

https://github.com/ethanphilipweiland/rotten-tomatoes
